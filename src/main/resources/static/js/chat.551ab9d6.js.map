{"version":3,"sources":["webpack:///./src/assets/img/left_black.png","webpack:///./src/views/Chat.vue?09a4","webpack:///src/views/Chat.vue","webpack:///./src/views/Chat.vue?6ed9","webpack:///./src/views/Chat.vue","webpack:///./src/assets/css/components/chat.css?0f78","webpack:///./src/assets/css/views/home.css?0e6a"],"names":["module","exports","render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","on","$event","$router","back","_v","_s","$conversacionElegida","user_dest","name","ref","onScroll","_l","mensaje","key","id","class","sender_id","userId","fecha","_e","staticStyle","message_type","substr","esArchivo","esImagen","esVideo","esAudio","adjuntar","changeAdjunto","type","indexOf","_k","keyCode","enviar","staticRenderFns","components","MensajeTexto","MensajeArchivo","MensajeImagen","MensajeVideo","MensajeAudio","data","mensajes","primeraPagina","currentPage","lastPage","mensajeOffset","actualizarTimer","props","computed","mounted","localStorage","getItem","getChat","actualizar","$refs","chatScroll","addEventListener","created","$eventHub","$on","methods","that","clearTimeout","setTimeout","extension","message","files","file","$route","params","$axios","getChatPage","pagina","pag","getSeparadores","fechas","filter","cantidad","length","i","m","created_at","scrollear","$nextTick","scrollToBottom","target","scrollTop","clientHeight","offset","limit","document","getElementById","texto","inputTexto","value","FormData","append","user_dest_id","isOverflown","adjuntoFiles","click","forEach","component"],"mappings":"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","file":"js/chat.551ab9d6.js","sourcesContent":["module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAqCAYAAAD1T9h6AAAABHNCSVQICAgIfAhkiAAAAVlJREFUWEfV2c1Nw0AQQOGXAhCUkBLoAOgESsiFHuggR1JBOHIDUQEUgEQJHDhyiCayI8da/86sd8b3jN+3q0ReZ4XtdQXsgQ3waTs6PW1leBOJfwOugV/gbgmEFaAZX6/JIggLQCpeEF/AbbUbhht9PkoLKBovFA2geLwG4CJ+LsBN/ByAq/ipAHfxUwAu48cC3MaPAbiOHwK4j+8DhIjvAoSJTwFCxbcB4eKbgJDxNaAr/q86Uf1ne5jXD97K4/Q7cKOfVWTCowDkDCuIyyIJupseAXJFRZwANeIDuGgtyhPwqluobJ/+bh8pu3biAXjOlqEYnDoTh0J0HerDIPreSoRADL1WcY8YAvT9xLr4Yo8BuEaMBbhFTAG4REwFuEPMAbhCzAW4QWgALhBaQHGEBaAPIX/0yWEp22UFSCF2wH228mqwJaCJeFkiXm5oDZCZa+An98rX8w+YCmb+NJKbQwAAAABJRU5ErkJggg==\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"home\"},[_c('div',{staticClass:\"home-body\"},[_c('div',{staticClass:\"home-right\"},[_c('div',{staticClass:\"chat\"},[_c('div',{staticClass:\"chat-top\"},[_c('img',{attrs:{\"src\":require(\"../assets/img/left_black.png\")},on:{\"click\":function($event){return _vm.$router.back()}}}),_c('p',{on:{\"click\":function($event){return _vm.$router.back()}}},[_vm._v(\" \"+_vm._s(_vm.$conversacionElegida != null ? _vm.$conversacionElegida.user_dest.name : \"\")+\" \")])]),_c('div',{ref:\"chatScroll\",staticClass:\"chat-scroll\",attrs:{\"id\":\"chatScroll\"},on:{\"scroll\":_vm.onScroll}},_vm._l((_vm.mensajes),function(mensaje){return _c('div',{key:mensaje.id,staticClass:\"chat-container\",class:{\n              'chat-mensaje-propio': mensaje.sender_id == _vm.userId\n            },attrs:{\"id\":mensaje.id}},[(mensaje.fecha != null)?_c('div',{staticClass:\"chat-separador\"},[_c('label',[_vm._v(_vm._s(mensaje.fecha))])]):_vm._e(),(mensaje.fecha == null)?_c('div',[(mensaje.sender_id != _vm.userId)?_c('span',{staticClass:\"chat-tail\"},[_c('svg',{staticStyle:{\"display\":\"block\"},attrs:{\"xmlns\":\"http://www.w3.org/2000/svg\",\"viewBox\":\"0 0 8 13\",\"width\":\"8\",\"height\":\"13\"}},[_c('path',{attrs:{\"opacity\":\".13\",\"fill\":\"#0000000\",\"d\":\"M1.533 3.568L8 12.193V1H2.812C1.042 1 .474 2.156 1.533 3.568z\"}}),_c('path',{attrs:{\"fill\":\"currentColor\",\"d\":\"M1.533 2.568L8 11.193V0H2.812C1.042 0 .474 1.156 1.533 2.568z\"}})])]):_vm._e(),(mensaje.sender_id == _vm.userId)?_c('span',{staticClass:\"chat-tail-out\"},[_c('svg',{staticClass:\"chat-tail-svg\",staticStyle:{\"display\":\"block\"},attrs:{\"xmlns\":\"http://www.w3.org/2000/svg\",\"viewBox\":\"0 0 8 13\",\"width\":\"8\",\"height\":\"13\"}},[_c('path',{attrs:{\"opacity\":\".13\",\"d\":\"M5.188 1H0v11.193l6.467-8.625C7.526 2.156 6.958 1 5.188 1z\"}}),_c('path',{attrs:{\"fill\":\"currentColor\",\"d\":\"M5.188 0H0v11.193l6.467-8.625C7.526 1.156 6.958 0 5.188 0z\"}})])]):_vm._e(),(\n                  mensaje.message_type != null &&\n                    mensaje.message_type.substr(11, 100) == 'TextMessage'\n                )?_c('MensajeTexto',{attrs:{\"mensaje\":mensaje}}):_vm._e(),(\n                  mensaje.message_type != null &&\n                    mensaje.message_type.substr(11, 100) == 'FileMessage' &&\n                    _vm.esArchivo(mensaje)\n                )?_c('MensajeArchivo',{attrs:{\"mensaje\":mensaje}}):_vm._e(),(\n                  mensaje.message_type != null &&\n                    mensaje.message_type.substr(11, 100) == 'FileMessage' &&\n                    _vm.esImagen(mensaje)\n                )?_c('MensajeImagen',{attrs:{\"mensaje\":mensaje}}):_vm._e(),(\n                  mensaje.message_type != null &&\n                    mensaje.message_type.substr(11, 100) == 'FileMessage' &&\n                    _vm.esVideo(mensaje)\n                )?_c('MensajeVideo',{attrs:{\"mensaje\":mensaje}}):_vm._e(),(\n                  mensaje.message_type != null &&\n                    mensaje.message_type.substr(11, 100) == 'FileMessage' &&\n                    _vm.esAudio(mensaje)\n                )?_c('MensajeAudio',{attrs:{\"mensaje\":mensaje}}):_vm._e()],1):_vm._e()])}),0),_c('div',{staticClass:\"chat-bottom\"},[_c('div',{staticClass:\"chat-adjuntar\",attrs:{\"title\":\"Adjuntar\"},on:{\"click\":function($event){return _vm.adjuntar()}}},[_c('input',{ref:\"adjuntoFiles\",staticClass:\"app-hide\",attrs:{\"type\":\"file\",\"multiple\":\"\"},on:{\"change\":function($event){return _vm.changeAdjunto()}}}),_c('img',{attrs:{\"src\":require(\"../assets/img/adjuntar.png\")}})]),_c('input',{ref:\"inputTexto\",attrs:{\"type\":\"text\",\"placeholder\":\"Escribe un mensaje aquí\",\"maxlength\":\"140\"},on:{\"keyup\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\")){ return null; }return _vm.enviar()}}}),_c('img',{staticClass:\"chat-enviar\",attrs:{\"src\":require(\"../assets/img/enviar.png\")},on:{\"click\":function($event){return _vm.enviar()}}})])])])])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"home\">\r\n    <div class=\"home-body\">\r\n      <div class=\"home-right\">\r\n        <div class=\"chat\">\r\n          <div class=\"chat-top\">\r\n            <img @click=\"$router.back()\" src=\"../assets/img/left_black.png\">\r\n            <p @click=\"$router.back()\">\r\n              {{\r\n              $conversacionElegida != null\r\n              ? $conversacionElegida.user_dest.name\r\n              : \"\"\r\n              }}\r\n            </p>\r\n          </div>\r\n          <div id=\"chatScroll\" class=\"chat-scroll\" ref=\"chatScroll\" @scroll=\"onScroll\">\r\n            <div\r\n              v-for=\"mensaje in mensajes\"\r\n              :key=\"mensaje.id\"\r\n              :id=\"mensaje.id\"\r\n              class=\"chat-container\"\r\n              v-bind:class=\"{\r\n                'chat-mensaje-propio': mensaje.sender_id == userId\r\n              }\"\r\n            >\r\n              <div v-if=\"mensaje.fecha != null\" class=\"chat-separador\">\r\n                <label>{{mensaje.fecha}}</label>\r\n              </div>\r\n              <div v-if=\"mensaje.fecha == null\">\r\n                <span class=\"chat-tail\" v-if=\"mensaje.sender_id != userId\">\r\n                  <svg\r\n                    xmlns=\"http://www.w3.org/2000/svg\"\r\n                    viewBox=\"0 0 8 13\"\r\n                    width=\"8\"\r\n                    height=\"13\"\r\n                    style=\"display: block;\"\r\n                  >\r\n                    <path\r\n                      opacity=\".13\"\r\n                      fill=\"#0000000\"\r\n                      d=\"M1.533 3.568L8 12.193V1H2.812C1.042 1 .474 2.156 1.533 3.568z\"\r\n                    ></path>\r\n                    <path\r\n                      fill=\"currentColor\"\r\n                      d=\"M1.533 2.568L8 11.193V0H2.812C1.042 0 .474 1.156 1.533 2.568z\"\r\n                    ></path>\r\n                  </svg>\r\n                </span>\r\n                <span class=\"chat-tail-out\" v-if=\"mensaje.sender_id == userId\">\r\n                  <svg\r\n                    class=\"chat-tail-svg\"\r\n                    xmlns=\"http://www.w3.org/2000/svg\"\r\n                    viewBox=\"0 0 8 13\"\r\n                    width=\"8\"\r\n                    height=\"13\"\r\n                    style=\"display: block;\"\r\n                  >\r\n                    <path\r\n                      opacity=\".13\"\r\n                      d=\"M5.188 1H0v11.193l6.467-8.625C7.526 2.156 6.958 1 5.188 1z\"\r\n                    ></path>\r\n                    <path\r\n                      fill=\"currentColor\"\r\n                      d=\"M5.188 0H0v11.193l6.467-8.625C7.526 1.156 6.958 0 5.188 0z\"\r\n                    ></path>\r\n                  </svg>\r\n                </span>\r\n                <MensajeTexto\r\n                  v-if=\"\r\n                    mensaje.message_type != null &&\r\n                      mensaje.message_type.substr(11, 100) == 'TextMessage'\r\n                  \"\r\n                  :mensaje=\"mensaje\"\r\n                ></MensajeTexto>\r\n                <MensajeArchivo\r\n                  v-if=\"\r\n                    mensaje.message_type != null &&\r\n                      mensaje.message_type.substr(11, 100) == 'FileMessage' &&\r\n                      esArchivo(mensaje)\r\n                  \"\r\n                  :mensaje=\"mensaje\"\r\n                ></MensajeArchivo>\r\n                <MensajeImagen\r\n                  v-if=\"\r\n                    mensaje.message_type != null &&\r\n                      mensaje.message_type.substr(11, 100) == 'FileMessage' &&\r\n                      esImagen(mensaje)\r\n                  \"\r\n                  :mensaje=\"mensaje\"\r\n                ></MensajeImagen>\r\n                <MensajeVideo\r\n                  v-if=\"\r\n                    mensaje.message_type != null &&\r\n                      mensaje.message_type.substr(11, 100) == 'FileMessage' &&\r\n                      esVideo(mensaje)\r\n                  \"\r\n                  :mensaje=\"mensaje\"\r\n                ></MensajeVideo>\r\n                <MensajeAudio\r\n                  v-if=\"\r\n                    mensaje.message_type != null &&\r\n                      mensaje.message_type.substr(11, 100) == 'FileMessage' &&\r\n                      esAudio(mensaje)\r\n                  \"\r\n                  :mensaje=\"mensaje\"\r\n                ></MensajeAudio>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div class=\"chat-bottom\">\r\n            <div class=\"chat-adjuntar\" title=\"Adjuntar\" @click=\"adjuntar()\">\r\n              <input\r\n                type=\"file\"\r\n                class=\"app-hide\"\r\n                @change=\"changeAdjunto()\"\r\n                ref=\"adjuntoFiles\"\r\n                multiple\r\n              >\r\n              <img src=\"../assets/img/adjuntar.png\">\r\n            </div>\r\n            <input\r\n              type=\"text\"\r\n              placeholder=\"Escribe un mensaje aquí\"\r\n              ref=\"inputTexto\"\r\n              v-on:keyup.enter=\"enviar()\"\r\n              maxlength=\"140\"\r\n            >\r\n            <img class=\"chat-enviar\" src=\"../assets/img/enviar.png\" @click=\"enviar()\">\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport MensajeTexto from \"@/components/MensajeTexto.vue\";\r\nimport MensajeArchivo from \"@/components/MensajeArchivo.vue\";\r\nimport MensajeImagen from \"@/components/MensajeImagen.vue\";\r\nimport MensajeVideo from \"@/components/MensajeVideo.vue\";\r\nimport MensajeAudio from \"@/components/MensajeAudio.vue\";\r\n\r\nexport default {\r\n  name: \"Chat\",\r\n  components: {\r\n    MensajeTexto,\r\n    MensajeArchivo,\r\n    MensajeImagen,\r\n    MensajeVideo,\r\n    MensajeAudio\r\n  },\r\n  data() {\r\n    return {\r\n      mensajes: [],\r\n      userId: null,\r\n      primeraPagina: true,\r\n      currentPage: 0,\r\n      lastPage: 0,\r\n      mensajeOffset: null,\r\n      actualizarTimer: null\r\n    };\r\n  },\r\n  props: {},\r\n  computed: {},\r\n  mounted() {\r\n    this.userId = localStorage.getItem(\"$userId\");\r\n    this.getChat(null, true);\r\n    this.actualizar();\r\n    this.mensajes = [];\r\n    this.$refs.chatScroll.addEventListener(\"touchmove\", this.onScroll);\r\n  },\r\n  created() {\r\n    this.$eventHub.$on(\"chat-get\", id => this.getChat(id, true));\r\n  },\r\n  methods: {\r\n    actualizar() {\r\n      var that = this;\r\n      clearTimeout(this.actualizarTimer);\r\n      this.actualizarTimer = setTimeout(function() {\r\n        that.getChat(null, false);\r\n        that.actualizar();\r\n      }, 3000);\r\n    },\r\n    esImagen(mensaje) {\r\n      var extension = mensaje.message.files[0].file\r\n        .split(\".\")\r\n        [mensaje.message.files[0].file.split(\".\").length - 1].toLowerCase();\r\n      if (\r\n        extension == \"png\" ||\r\n        extension == \"jpg\" ||\r\n        extension == \"svg\" ||\r\n        extension == \"jpeg\"\r\n      ) {\r\n        return true;\r\n      } else {\r\n        return false;\r\n      }\r\n    },\r\n    esVideo(mensaje) {\r\n      var extension = mensaje.message.files[0].file\r\n        .split(\".\")\r\n        [mensaje.message.files[0].file.split(\".\").length - 1].toLowerCase();\r\n      if (\r\n        extension == \"webm\" ||\r\n        extension == \"mkv\" ||\r\n        extension == \"flv\" ||\r\n        extension == \"mp4\" ||\r\n        extension == \"mov\" ||\r\n        extension == \"avi\"\r\n      ) {\r\n        return true;\r\n      } else {\r\n        return false;\r\n      }\r\n    },\r\n    esAudio(mensaje) {\r\n      var extension = mensaje.message.files[0].file\r\n        .split(\".\")\r\n        [mensaje.message.files[0].file.split(\".\").length - 1].toLowerCase();\r\n      if (extension == \"m4a\" || extension == \"qt\" || extension == \"4mb\") {\r\n        return true;\r\n      } else {\r\n        return false;\r\n      }\r\n    },\r\n    esArchivo(mensaje) {\r\n      if (\r\n        this.esImagen(mensaje) == false &&\r\n        this.esVideo(mensaje) == false &&\r\n        this.esAudio(mensaje) == false\r\n      ) {\r\n        return true;\r\n      } else {\r\n        return false;\r\n      }\r\n    },\r\n    getChat(id, scroll) {\r\n      if (id == null) {\r\n        id = this.$route.params.id;\r\n      } else {\r\n        this.mensajes = [];\r\n        this.primeraPagina = true;\r\n      }\r\n      if (id != null) {\r\n        var that = this;\r\n        this.$axios\r\n          .get(this.$localurl + \"/api/messages/\" + id)\r\n          .then(function(response) {\r\n            if (\r\n              that.primeraPagina == true &&\r\n              !that.isOverflown(document.getElementById(\"chatScroll\"))\r\n            ) {\r\n              that.primeraPagina = false;\r\n              that.getChatPage(2);\r\n            }\r\n            var scrollear = false;\r\n            that.lastPage = response.data.messages.last_page;\r\n            response.data.messages.data.reverse();\r\n            response.data.messages.data.forEach(m => {\r\n              if (\r\n                !that.mensajes.some(mensaje => mensaje.id == m.id) &&\r\n                m.conversation_id == that.$route.params.id\r\n              ) {\r\n                that.mensajes.push(m);\r\n                scrollear = true;\r\n              }\r\n            });\r\n            if (scrollear == true) {\r\n              that.mensajeOffset = that.mensajes[that.mensajes.length - 1];\r\n            }\r\n            that.getSeparadores(scroll);\r\n          })\r\n          .catch(function(response) {\r\n            clearTimeout(that.actualizarTimer);\r\n            if (\r\n              response != null &&\r\n              response.response != null &&\r\n              response.response.status == 401\r\n            ) {\r\n              localStorage.removeItem(\"$expire\");\r\n              if (window.location.pathname.split(\"/\").reverse()[0] != \"login\") {\r\n                that.$router.push(\"/login\");\r\n              }\r\n            }\r\n          });\r\n      }\r\n    },\r\n    getChatPage(pagina) {\r\n      this.mensajeOffset = this.mensajes[0];\r\n      if (this.mensajeOffset != null && this.mensajeOffset.id == null) {\r\n        this.mensajeOffset = this.mensajes[1];\r\n      }\r\n      this.currentPage = pagina;\r\n      var pag = \"\";\r\n      if (pagina != null) {\r\n        pag = \"?page=\" + pagina;\r\n      }\r\n      var that = this;\r\n      this.$axios\r\n        .get(this.$localurl + \"/api/messages/\" + this.$route.params.id + pag)\r\n        .then(function(response) {\r\n          response.data.messages.data.reverse();\r\n          that.mensajes = response.data.messages.data.concat(that.mensajes);\r\n          that.getSeparadores(true);\r\n        })\r\n        .catch(function(response) {\r\n          if (\r\n            response != null &&\r\n            response.response != null &&\r\n            response.response.status == 401\r\n          ) {\r\n            localStorage.removeItem(\"$expire\");\r\n            if (window.location.pathname.split(\"/\").reverse()[0] != \"login\") {\r\n              that.$router.push(\"/login\");\r\n            }\r\n          }\r\n        });\r\n    },\r\n    getSeparadores(scrollear) {\r\n      var fechas = [];\r\n      this.mensajes = this.mensajes.filter(m => m.fecha == null);\r\n      var cantidad = this.mensajes.length;\r\n      for (var i = 0; i < cantidad; i++) {\r\n        var m = this.mensajes[i];\r\n        if (m.created_at != null) {\r\n          var d = new Date(m.created_at);\r\n          d.setHours(d.getHours() + 3);\r\n          let day = d.getDate();\r\n          let month = d.getMonth() + 1;\r\n          let year = d.getFullYear();\r\n          let fecha = day + \"/\" + month + \"/\" + year;\r\n          var today = new Date();\r\n          let todayday = today.getDate();\r\n          let todaymonth = today.getMonth() + 1;\r\n          let todayyear = today.getFullYear();\r\n          if (day != todayday || month != todaymonth || year != todayyear) {\r\n            if (fechas.includes(fecha) == false) {\r\n              var days = [\r\n                \"Domingo\",\r\n                \"Lunes\",\r\n                \"Martes\",\r\n                \"Miércoles\",\r\n                \"Jueves\",\r\n                \"Viernes\",\r\n                \"Sábado\"\r\n              ];\r\n              fecha = days[d.getDay()] + \" \" + fecha;\r\n              if (!this.mensajes.some(m => m.fecha == fecha)) {\r\n                this.mensajes.splice(i, 0, { fecha: fecha });\r\n                cantidad++;\r\n              }\r\n            }\r\n          } else {\r\n            if (!this.mensajes.some(m => m.fecha == \"HOY\")) {\r\n              this.mensajes.splice(i, 0, { fecha: \"HOY\" });\r\n              cantidad++;\r\n            }\r\n          }\r\n        }\r\n      }\r\n      if (scrollear == true) {\r\n        var that = this;\r\n        this.$nextTick(() => {\r\n          that.scrollToBottom();\r\n        });\r\n      }\r\n    },\r\n    onScroll() {\r\n      var target = this.$refs.chatScroll;\r\n      if (target.scrollTop < target.clientHeight * 0.1) {\r\n        if (this.currentPage < this.lastPage) {\r\n          this.offset = this.offset + this.limit;\r\n          this.currentPage++;\r\n          this.getChatPage(this.currentPage);\r\n        }\r\n      }\r\n    },\r\n    scrollToBottom() {\r\n      var that = this;\r\n      this.$nextTick(() => {\r\n        if (that.mensajeOffset != null) {\r\n          if (document.getElementById(that.mensajeOffset.id) != null) {\r\n            document.getElementById(\r\n              \"chatScroll\"\r\n            ).scrollTop = document.getElementById(\r\n              that.mensajeOffset.id\r\n            ).offsetTop;\r\n          } else {\r\n            setTimeout(function() {\r\n              that.scrollToBottom();\r\n            }, 200);\r\n          }\r\n        }\r\n      });\r\n    },\r\n    enviar() {\r\n      this.scrollToBottom();\r\n      var texto = this.$refs.inputTexto.value;\r\n      if (texto != \"\") {\r\n        this.$refs.inputTexto.value = \"\";\r\n        var data = new FormData();\r\n        data.append(\"message\", texto);\r\n        data.append(\"receiver_id\", this.$route.params.user_dest_id);\r\n        var that = this;\r\n        this.$axios\r\n          .post(this.$localurl + \"/api/messages/textMessage\", data)\r\n          .then(function() {\r\n            that.getChat(null, true);\r\n          })\r\n          .catch(function(response) {\r\n            if (\r\n              response != null &&\r\n              response.response != null &&\r\n              response.response.status == 401\r\n            ) {\r\n              localStorage.removeItem(\"$expire\");\r\n              if (window.location.pathname.split(\"/\").reverse()[0] != \"login\") {\r\n                that.$router.push(\"/login\");\r\n              }\r\n            }\r\n            alert(\"Se produjo un error, reintente\");\r\n          });\r\n      }\r\n    },\r\n    isOverflown(element) {\r\n      return (\r\n        element.scrollHeight > element.clientHeight ||\r\n        element.scrollWidth > element.clientWidth\r\n      );\r\n    },\r\n    adjuntar() {\r\n      this.$refs.adjuntoFiles.click();\r\n    },\r\n    changeAdjunto() {\r\n      if (this.$refs.adjuntoFiles.files.length > 0) {\r\n        var data = new FormData();\r\n        data.append(\"message\", \"archivos\");\r\n        data.append(\"receiver_id\", this.$route.params.user_dest_id);\r\n\r\n        this.$refs.adjuntoFiles.files.forEach(function(value, i) {\r\n          data.append(\"file[\" + i + \"]\", value);\r\n        });\r\n\r\n        var that = this;\r\n        this.$axios\r\n          .post(this.$localurl + \"/api/messages/fileMessage\", data)\r\n          .then(function() {\r\n            that.getChat(null, true);\r\n          })\r\n          .catch(function(response) {\r\n            if (\r\n              response != null &&\r\n              response.response != null &&\r\n              response.response.status == 401\r\n            ) {\r\n              localStorage.removeItem(\"$expire\");\r\n              if (window.location.pathname.split(\"/\").reverse()[0] != \"login\") {\r\n                that.$router.push(\"/login\");\r\n              }\r\n            }\r\n            alert(\"Se produjo un error, reintente\");\r\n          });\r\n      }\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped src=\"../assets/css/components/chat.css\"></style>\r\n<style scoped src=\"../assets/css/views/home.css\"></style>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Chat.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Chat.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Chat.vue?vue&type=template&id=3d82cb35&scoped=true&\"\nimport script from \"./Chat.vue?vue&type=script&lang=js&\"\nexport * from \"./Chat.vue?vue&type=script&lang=js&\"\nimport style0 from \"../assets/css/components/chat.css?vue&type=style&index=0&id=3d82cb35&scoped=true&lang=css&\"\nimport style1 from \"../assets/css/views/home.css?vue&type=style&index=1&id=3d82cb35&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"3d82cb35\",\n  null\n  \n)\n\nexport default component.exports","import mod from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!./chat.css?vue&type=style&index=0&id=3d82cb35&scoped=true&lang=css&\"; export default mod; export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!./chat.css?vue&type=style&index=0&id=3d82cb35&scoped=true&lang=css&\"","import mod from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!./home.css?vue&type=style&index=1&id=3d82cb35&scoped=true&lang=css&\"; export default mod; export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!./home.css?vue&type=style&index=1&id=3d82cb35&scoped=true&lang=css&\""],"sourceRoot":""}